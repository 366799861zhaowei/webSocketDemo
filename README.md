    Web 即时通讯技术

        就是为了服务器端可以即时地将数据的更新或变化反应到客户端

        实现即时通讯的方法主要有：短轮询、长轮询(comet)、长连接(SSE)、WebSocket。

        短轮询：浏览器每隔一段时间向浏览器发送http请求，服务器端在收到请求后，不论是否有数据更新，都直接进行响应。   eg：setInterval
              应用场景：传统的web通信模式。后台处理数据，需要一定时间，前端想要知道后端的处理结果，就要不定时的向后端发出请求以获得最新情况。
              优点:简单！
              缺点：请求中有大半是无用，难于维护，浪费带宽和服务器资源；响应的结果没有顺序（因为是异步请求，当发送的请求没有返回结果的时候，后面的请求又被发送。而此时如果后面的请求比前面的请 求要先返回结果，那么当前面的请求返回结果数据时已经是过时无效的数据了）。 eg：疫情 预警列表推送

        长轮询comet：客户端向服务器发送Ajax请求，服务器接到请求后hold住连接，直到有新消息才返回响应信息并关闭连接，客户端处理完响应信息后再向服务器发送新的请求。
                优点：在无消息的情况下不会频繁的请求，耗费资源小。
                缺点：服务器hold连接会消耗资源，返回数据顺序无保证，难于管理维护。

        两者本身存在着缺陷：轮询需要更快的处理速度；长轮询则更要求处理并发的能力；两者都是“被动型服务器”的体现：服务器不会主动推送信息，而是在客户端发送ajax请求后进行返回的响应。而理想的模型是"在服务器端数据有了变化后，可以主动推送给客户端"，这种"主动型"服务器是解决这类问题的很好的方案。

        SSE长连接：Server Sent Event 是一种可以主动从服务端推送消息的技术 ，它给客户端发送的不是一次性的数据包，而是一个stream流，格式为text/event-stream。所以客户端不会关闭连接，会一直等着服务器发过来的新的数据流。

                应用场景：通知
                SSE与WebSocket有相似功能，都是用来建立浏览器与服务器之间的通信渠道。两者的区别在于：

                WebSocket 是全双工通道，可以双向通信，功能更强；SSE 是单向通道，只能服务器向浏览器端发送。

                WebSocket 是一个新的协议，需要服务器端支持；SSE 则是部署在 HTTP 协议之上的，现有的服务器软件都支持。

                SSE 是一个轻量级协议，相对简单；WebSocket 是一种较重的协议，相对复杂。

                SSE 默认支持断线重连，WebSocket 则需要额外部署。

                SSE 支持自定义发送的数据类型。

        什么是长连接什么是短连接(在HTTP/1.0中默认使用短连接。也就是说，客户端和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断连接。当客户端浏览器访问的某个HTML或其他类型的Web页中包含有其他的Web资源（如JavaScript文件、图像文件、CSS文件等），每遇到这样一个Web资源，浏览器就会重新建立一个HTTP会话。 而从HTTP/1.1起，默认使用长连接，用以保持连接特性。使用长连接的HTTP协议，会在响应头加入这行代码：)
        在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，客户端再次访问这个服务器时，会继续使用这一条已经建立的连接。Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接需要客户端和服务端都支持长连接。 HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。


        webSocket: 在2008年被提出，其通信协议于2011被制定为标准,与http不同，websocket支持全双工通信（即：在客户端和服务之间双向通信）
                    出现之前：客户端与服务器通常采用http轮询和Comet等方式保持长链接。然而，这么做无疑会对服务端造成资源消耗，因为HTTP请求包含较长的头文件，只传递了少许的有用信息，十分消耗资源。

        websocket心跳机制：顾名思义，就是客户端每隔一段时间向服务端发送一个特有的心跳消息，每次服务端收到消息后只需将消息返回，此时，若二者还保持连接，则客户端就会收到消息，若没收到，则说明连接断开，此时，客户端就要主动重连，完成一个周期

对于简单的推送需求又不考虑兼容低版本浏览器，推荐使用 server-sent Events。

如果需要多条双向数据实时交互或需要二进制传输，推荐 websocket。

对于还要考虑低版本浏览器，那么还是用轮询来实现功能。
